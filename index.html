<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Recettes détaillées avec Fuse.js</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 1rem; background: #fafafa; color: #222; }
    input[type="search"] {
      width: 100%; padding: 0.8rem; font-size: 1.1rem; margin-bottom: 1rem; border: 2px solid #4CAF50; border-radius: 5px;
    }
    ul {
      list-style: none; padding: 0; max-height: 70vh; overflow-y: auto; background: white; border: 1px solid #ccc; border-radius: 6px;
    }
    li {
      padding: 1rem; border-bottom: 1px solid #eee; white-space: pre-wrap; font-size: 0.9rem; line-height: 1.3;
    }
    .pagination {
      margin-top: 1rem; display: flex; justify-content: center; gap: 1rem;
    }
    button {
      padding: 0.5rem 1rem; font-size: 1rem; cursor: pointer; border-radius: 5px; border: 1px solid #4CAF50; background: #4CAF50; color: white;
    }
    button:disabled {
      background: #ccc; border-color: #ccc; cursor: not-allowed;
    }
  </style>
  <script src="fuse.min.js"></script>

</head>
<body>

  <h1>Recettes détaillées avec recherche Fuse.js (10 000)</h1>
  <input type="search" id="searchInput" placeholder="Chercher une recette, ingrédient, préparation..." autocomplete="off" />

  <ul id="recipeList"></ul>

  <div class="pagination">
    <button id="prevBtn" disabled>Précédent</button>
    <span id="pageInfo">Page 1</span>
    <button id="nextBtn" disabled>Suivant</button>
  </div>

  <script>
    const totalRecipes = 10000;
    const pageSize = 50;
    let currentPage = 1;
    let results = [];
    let fuse;

    const baseTitles = [
      "Soupe aux légumes",
      "Salade fraîche",
      "Poulet rôti",
      "Tarte aux pommes",
      "Gratin dauphinois",
      "Omelette au fromage",
      "Pâtes à la bolognaise",
      "Poisson grillé",
      "Crêpes sucrées",
      "Gâteau au yaourt"
    ];

    const baseIngredients = [
      "légumes frais, huile d'olive, sel, poivre",
      "salade verte, tomates, vinaigrette, herbes",
      "poulet entier, herbes de Provence, ail, huile",
      "pommes, pâte brisée, sucre, cannelle",
      "pommes de terre, crème, ail, fromage",
      "œufs, fromage râpé, beurre, sel",
      "pâtes, viande hachée, tomates, oignons",
      "filet de poisson, citron, herbes, huile",
      "farine, œufs, lait, sucre",
      "yaourt, farine, œufs, sucre"
    ];

    const basePreparations = [
      "Mélangez les ingrédients et faites cuire doucement.",
      "Coupez, assaisonnez, et servez frais.",
      "Assaisonnez et faites rôtir au four pendant 1 heure.",
      "Disposez les fruits sur la pâte et enfournez 40 minutes.",
      "Coupez en tranches, nappez de crème, et faites gratiner.",
      "Battez les œufs avec le fromage, cuisez à la poêle.",
      "Préparez la sauce avec viande et tomates, servez avec pâtes.",
      "Assaisonnez, puis grillez à la poêle ou au four.",
      "Préparez la pâte, cuisez des crêpes fines et dorées.",
      "Mélangez tout, versez dans un moule et enfournez."
    ];

    // Générer les recettes
    const data = [];
    for(let i=1; i<=totalRecipes; i++) {
      const idx = (i - 1) % baseTitles.length;
      data.push({
        title: `${baseTitles[idx]} n°${i}`,
        ingredients: baseIngredients[idx],
        preparation: basePreparations[idx]
      });
    }

    // Init Fuse
    fuse = new Fuse(data, {
      keys: ['title', 'ingredients', 'preparation'],
      threshold: 0.3,
      ignoreLocation: true,
      minMatchCharLength: 1,
    });

    const list = document.getElementById('recipeList');
    const input = document.getElementById('searchInput');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const pageInfo = document.getElementById('pageInfo');

    function renderPage(page) {
      list.innerHTML = '';
      const start = (page - 1) * pageSize;
      const end = start + pageSize;
      const pageItems = results.slice(start, end);

      if(pageItems.length === 0) {
        const li = document.createElement('li');
        li.textContent = 'Aucune recette trouvée.';
        list.appendChild(li);
      } else {
        for(const res of pageItems) {
          const li = document.createElement('li');
          li.textContent =
            `${res.item.title}\nIngrédients : ${res.item.ingredients}\nPréparation : ${res.item.preparation}`;
          list.appendChild(li);
        }
      }

      pageInfo.textContent = `Page ${page} / ${Math.max(1, Math.ceil(results.length / pageSize))}`;
      prevBtn.disabled = page <= 1;
      nextBtn.disabled = page >= Math.ceil(results.length / pageSize);
    }

    function doSearch(query) {
      if(!query) {
        results = data.map(item => ({ item }));
      } else {
        results = fuse.search(query);
      }
      currentPage = 1;
      renderPage(currentPage);
    }

    input.addEventListener('input', e => {
      doSearch(e.target.value.trim());
    });

    prevBtn.addEventListener('click', () => {
      if(currentPage > 1) {
        currentPage--;
        renderPage(currentPage);
      }
    });

    nextBtn.addEventListener('click', () => {
      if(currentPage < Math.ceil(results.length / pageSize)) {
        currentPage++;
        renderPage(currentPage);
      }
    });

    // Initial display
    doSearch('');
  </script>

</body>
</html>
